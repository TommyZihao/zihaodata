# 第一个视频

大家好，我是同济大学张子豪，欢迎来到大数据可视化系列微课。

这次的微课，用四集视频带领大家手把手制作**北京上海广州成都沈阳这五个城市六年间PM2.5的大数据可视化**。这是一个麻雀虽小五脏俱全的数据挖掘案例。从数据获取、清洗、汇总、整理，到使用tableau软件进行可视化。

## 第一集视频

第一集视频，就是现在这个视频，宏观介绍一下整个流程。

## 第二集视频

第二集视频，我们来分析最终的可视化成果，生动直观展现这二十六万条数据背后的规律。

大家可以点击视频下方的链接在线观看我制作的数据可视化效果，可以点击每个数据点进行交互。

<https://public.tableau.com/profile/tommy7953#!/vizhome/2010-2016PM2_50415/1_1?publish=yes>

剧透一下几个有趣的结论，北京冬天的空气质量很差劲，上海和广州的空气挺好。越刮大风的时候PM2.5越低，成都的空气质量比较差的原因是不刮大风。

## 第三集视频

第三讲视频，介绍数据来源，也就是数据集，这个项目的原始数据集是在著名的大数据竞赛平台kaggle上，我们将详细介绍原始数据的数据结构，以及之后的数据清洗、汇总、整理的过程。如果你想偷懒，不想干清洗数据这种简单粗暴的苦活累活。

我已经花了一下午的时间把数据清洗好了，而且把二十六万多条数据全都翻译成了中文，大家也可以在我的网站<https://steam.coderai.cn/dataset>下载。这个微课也是这个网站上线的第一个免费微课，以后会继续制作更多免费、有趣的小案例供大家学习。

用excel打开这个数据集，就可以看到这二十六万多条源数据，包含时间、季节、每个城市的三个PM2.5测点的测量数据，以及平均值，还有露点、相对湿度、大气压、温度、风速、风向、降水量这些气象数据。

每个城市都有三个PM2.5测点，比如上海是静安寺、闵行区、US_Post，北京是东四环、农展馆、US_Post，成都是杜甫草堂、沙河铺和US_Post，广州是火车站、第五中学和US_Post，沈阳是太原街、小河沿，和US_Post。

缺失值我标记上了“缺失”。三个测量点里面，US_Post缺失值比较少，可以只用它代表PM2.5的测量值，也可以用三个测点的平均值代表PM2.5的测量值，也可以单独分析某一个测点的数据。这都是由你自己决定的。

比如，上海交通大学有徐汇校区和闵行校区，就可以分析徐汇区和闵行区的PM2.5差异。

## 第四集视频

第四集视频中，我将手把手教大家使用大数据可视化软件tableau，导入这个数据集，完成PM2.5和各类气象变量的大数据可视化。tableau这个软件非常简单易学。只需要把代表不同变量的小圈圈拖动到指定位置就行。比如看PM2.5与风速的关系，只需要把风速拖到横轴，把PM2.5拖到纵轴，把城市拖到颜色，用颜色表示不同城市。把风向拖到形状，用不同形状表示不同风向。再把每个数据点都显示出来，马上就可以绘制出高大上的图表。

大家可以点击视频下方的链接看到跟我一样的页面，还可以点击图表跟数据进行交互。我们既可以绘制单张可视化图表，也可以将多张图表放在一个窗口里形成仪表盘，还可以将图表和仪表盘串成一个序列，辅以说明性文字，形成一个故事，引导阅读者自己探索数据，引人入胜。



需要声明的是，我们全程不需要编程，一行代码都不用写。你可能会问，这是kaggle大数据竞赛平台上的数据，不都是那些算法大佬、编程大牛，和那些秃头博士玩的么，动不动搞个神经网络、深度学习，决策树，随机森林什么的，动不动搞个tensorflow，keras，caffe，sklearn各种高大上的工具包。你小子一行代码都不写，能分析出啥？这恰恰就是我想说的，数据挖掘是发现海量数据背后的规律，那么直观的可视化往往是最能发现规律的。正所谓一图胜千言。

这也是我制作这个机器学习和数据可视化系列教程的初衷：人人皆可机器学习，人人皆可人工智能，人人皆可玩转大数据。



这个教程我准备了整整一个月，目前我所有的视频都是免费开源的。大家可以扫描这个赞赏码打赏，这笔钱将用于视频后期处理以及字幕校对，为大家后续提供更加优质的内容。

![微信扫码支持子豪兄制作树莓派教程](https://upload-images.jianshu.io/upload_images/13714448-4be7dc29e22207b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/300)

大家可以关注我的B站专栏“同济子豪兄”和知乎专栏“人工智能小技巧”。

马上开始的下一讲视频，就带各位看看北京、上海、广州、成都、沈阳这五个城市2010到2016六年来的二十六万条PM2.5数据能发掘出什么秘密。


# 第二个视频

大家好，我是同济大学张子豪，下面介绍中国北上广、成都沈阳这五个城市2010到2016连续六年PM2.5的大数据可视化。原始数据来自于大数据竞赛网站kaggle，总共二十六万条，包含了PM2.5数据、风速、降水量、温度、露点、湿度等气象数据。我使用tabelau这个数据可视化工具绘制出如下图表。

大家可以点击视频下方的链接在线观看我制作的数据可视化效果，可以点击每个数据点进行交互。

PM2.5指的是空气中直径小于等于 *2.5* 微米的颗粒物。PM2.5粒径小，面积大，活性强，易附带有毒、有害物质，因而对人体健康和大气环境质量的影响更大。

# 地图

首先我们来看PM2.5在五个城市的平均水平，在地图上画出五个城市，用颜色深浅表示PM2.5平均值。

北京的PM2.5普遍较高，上海和广州的PM2.5普遍较低，和我原本想象的不同，成都其实空气质量也有待提高。

这可能是因为四川盆地不利于污染物扩散，沈阳PM2.5高的原因可能是因为东北冬天烧暖气。

如果这个推测成立，沈阳的PM2.5在冬天应该远高于夏天。

在第二个图中我们看到，果然如此。

# 年份

随着中国关停钢铁小厂，化解落后产能，禁止焚烧秸秆，大力植树造林，治理雾霾。成效非常显著，各城市PM2.5大趋势都在逐年降低。但北京的雾霾仍旧远远严重于南方城市。

# 季节

我们用不同颜色表示不同城市。帝王金色表示帝都北京，蓝色表示靠海的上海，红色表示“花重锦官城”的成都，棕黑色表示广州。

对于除北京之外的城市，夏天的PM2.5都是全年最低的。

对于沈阳和成都，冬天的PM2.5要远远高于夏秋两季。

让我们将时间粒度缩小到月份级别

# 月份

进一步验证了我们的结论，红绿两条线分别表示成都和沈阳，这两个城市全年PM2.5最高与最低值竟然相差三倍。



# 小时

我们将时间粒度缩小到小时级别，可以看到PM2.5在一天中各个时段的分布。

对于北京、成都、沈阳，下午两三点是一天中PM2.5最低的时候，这可能与植物作用和气温有关。

对于上海和广州就没有这个规律，全天PM2.5基本一样。



# 风速1

下面这个图特别有意思，反应了PM2.5与风速的关系。生活经验高速我们，刮大风的时候空气质量好，从图表中一看果然是这样。这是上海的情况，颜色表示季节。上海在冬天风刮的最大，而且普遍是方框，也就是东南风。这个我深有体会，我们同济大学图书馆门口的自行车经常被东南风刮倒一大片。

# 风速2

我们换成北京看看，北京也是在冬天刮风刮的最大，刮的是西北风。也同样符合风速越大空气质量越好的规律。在这里出现了一些小异常，我们仔细查看一下这团数据，发现这几个数据的数据号相近，也就是说在原始数据中是紧挨在一起的。那么对这个现象的解释就是，这是一股妖风，可能是孙猴子用芭蕉扇扇的，也可能是原始数据中的错误。

# 风速3

将几个城市的PM2.5和风速放到同一个图里，用不同颜色表示不同城市。可以看到，上海刮风最大，沈阳次之，广州再次之，成都的风最小。这也符合成都平原天府之国，没有大风的生活常识。

# 风向

还可以绘制出PM2.5与风向的关系。对于上海来说，刮东南风的时候PM2.5低，因为上海东南方是大海，没有污染，刮西北风的时候就会把内陆的污染物吹过来。

对于沈阳来说也一样。沈阳的东北方是吉林长春老工业基地，刮东北风的时候空气就不太好。

# 降水量

说完了风，再说说降水量。生活经验告诉我们，下雨的时候空气清新，从图表上也能看出来，和刮风是类似的。

对于上海，下最大暴雨是这个点，发生在2013年9月13日下午四点，我们一看历史新闻，果然这一天发生了特大暴雨。

累计降水量也是同理。

# 气象数据

下面几个图表都是PM2.5与各种气象变量的关系，在气象1这个图里，横轴表示温度，纵轴表示PM2.5，不同颜色表示不同城市，不同形状表示不同风向。

可以看出，成都和广州温度最高，上海稍微冷一些，沈阳最冷，最后还可以把北京加上。北京冬冷夏热，温差还是挺大的。

下面这个图展示了PM2.5与相对湿度的关系，这个图特别值得琢磨琢磨。

首先，图上成都、上海、沈阳这三个城市的相对湿度都出现了断层，但是北京和广州就没有断层。我请教了几个学环境工程的同学，他们都无法给出合理的解释。

第二，PM2.5的最大值与相对湿度呈正相关，特别是对于沈阳，PM2.5爆表的时候都是相对湿度比较大的时候。这个可能跟气溶胶和空气的粘度有关。

我们可以继续深挖这个图，看看沈阳PM2.5爆表的时候是什么季节，什么天气。

接下来几个图是PM2.5与温度、露点温度的关系。

最后是这个气象图，横轴温度，纵轴湿度，越靠右上角的城市越闷热，越靠左下角的城市越凉爽，颜色越深、圆圈越大表示PM2.5平均值越高。我们同时用了颜色和圆圈大小表示PM2.5平均值，这叫做重复编码，是数据可视化的一个小技巧，可以强调关键信息，也就是展示北京的PM2.5形势有多严峻。

# 仪表盘

我们既可以绘制单张可视化图表，也可以将多张图表放在一个窗口里形成仪表盘，还可以将图表和仪表盘串成一个序列，辅以说明性文字，形成一个故事，引导阅读者自己探索数据，引人入胜。



在下一讲，我们来看看在kaggle大数据竞赛网站上的原始数据集，以及数据清洗、汇总、整理、翻译的整个工作，

如果你觉得，数据清洗嘛，简单粗暴，没什么技术含量，又贼耗时间，那可以直接在我的网站上下载我制作好的数据集。

其实真正的机器学习工程师，百分之八十的时间都花在数据清洗上了。

最后，打赏！打赏！打赏！




